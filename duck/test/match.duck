import prelude
main = testAll

-- Verify that the first matching alternative is chosen

f ([],_) = 1
f (_,[]) = 2

g x = case x of
  _, [] -> 1
  [], _ -> 2

h x = case x of 
  _, [] -> 1
  _, [_] -> 2
  [], _ -> 3

test_f = assert \ f ([],[]) == 1
test_g = assert \ g ([],[]) == 1
test_h = assert \ h ([1], [1]) == 2

-- Repeated default matches should be harmless

r x = case x of
  y -> 1
  z -> 2
  w -> 3

test_r = assert \ r 4 == 1
